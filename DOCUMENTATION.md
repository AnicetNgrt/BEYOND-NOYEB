# Emergence_bot_js documentation
## Create dialogues
Dialogues are located within two files: **"dialogues.js"** and **"answers.js"**. The bot has a dialogue manager built within it, therefore dialogues are just big tabs with a lot of data inside. You will learn how to edit this data in order to create your very own dialogues, but for now, let see how dialogues are structured.

*Note that decent high level programming knowledges / js knowledges are required in order to understand this guide.*

***Main structure***

![Emoji based answering dialogue example](https://i.imgur.com/fFPqD4d.png)
*Emoji based answering dialogue example*

Dialogues are discord.richEmbeds messages generated from the data contained in **"dialogues.js"** and **"answers.js"**. 
There is two part, question part generated from **"dialogues.js"** data, and answer part, generated from **"answers.js"** data.  
<br/>

**QUESTIONS**

```javascript 
// source code of the question part from the dialogue above
BotHello: {
      texte: function (up, am) {return "Hi! Welcome into your personnal tab.\nSo let's get started, what do you want to do ?"},
      npc: npcList.GameMaster,
      answers: function (up) {return [4,"area","launch","stats","menu"]},
      footer: function (up) {return "Pro Tips: click on one of thoses reaction emotes to make your choice."}
    },
```

The dialogue's question part is a js object. 
It has several properties. 
Let see what each propery contains and how to access them.
```javascript 
dg.corp["BotHello"]; // gives you the whole object (you can replace "BotHello" with a string variable which is equal to "BotHello")

//Here you first need a variable called "member" which type is discord.guild.member 
//(see discord.js documentation)
//It must represents the user you are currently playing the dialogue to.
dg.corp["BotHello"].texte(member, dataBase[member.user.id].answerMaterial); // calls a method in dg.corp["BotHello"] called "texte", it returns the question's text (possibly depending on the user), in the example above it is the green text.

dg.corp["BotHello"].npc; // gives you the npc object representing the npc who tells the message. In the example above it is the GameMaster npc, which is a special one. From this npc object you can get it's "picture" property which is then put as the thumbnail, and it's "name" property which is then put as the dialogue's title.

dg.corp["BotHello"].footer(member); // gives the footer text (possibly depending on the user). The footer is the little grey text at the bottom of the message, it is usefull to put jokes, lore or pro tips.

dg.corp["BotHello"].answers(member); // this returns the list of all the possible answers (possibly depending on the user) for this question and the number of possible answers.
// since it returns a list you can do:
dg.corp["BotHello"].answers(member)[0]; // gives the number of answers
dg.corp["BotHello"].answers(member)[1]; // gives the first answer's name, you should check if dg.corp["BotHello"].answers(member)[0] >= 1 == true first.
dg.rep; // this is the answers tab
var theAnswerName = dg.corp["BotHello"].answers(member)[1]; // stores the name of the first possible answer in a string variable called theAnswerName.
dg.rep[theAnswerName]; //gives the answer object.
```
<br/>

**REACTION EMOJI BASED ANSWERS**

The dialogues generated by our dialogue manager are featuring an innovative way of creating buttons within discord messages: **reaction emojis !**
How it works basically:

 1. The bot has a list of all the possible answers and their
    corresponding emojis. 
 2. It reacts first with all the possible
    answers' emoji
 3. It waits for the user to react once more (aka
    pressing a little emoji button) in order to know which answer he
    selected.

 

Emoji based answers are also js objects with properties:
```javascript
Eddie0a2: {
      texte: function (up) {return "I would like you to make shure it can not send data to nanoteck, I mean I don't want them to track my position at least"},
      emote: function (up) {return "ðŸ”§"},
      exit: function (up) {           // Ok, cool stuff to show here, since exit is a function which has access to member data, you can do a little bit more than just returning the exit dialogue's name. 
        quests["Eddie0"].start(up);      // As you can see you can do stuff whenever the code need to access the exit. For instance, here it is called when the user finally selects this answer. Since selecting this answer should make the user start a new quest, I can call before the mendatory return "dialogueName"; optional code saying "hey start this quest for this user please thanks".
        return "ExitDialogue";        // Whenever you add code in thoses methods, never forget to add a return at the end following the right variable type !!!
      },
```
Let's breakdown everything.
```javascript
//let's optimize this a bit
var myAns = dg.rep["Eddie0a2"]; // stores the answer object within a variable called myAns, which is way easier to type than dg.rep["Eddie0a2"].

myAns.texte(member); // similar to dg.corp["dialogueName"].texte() method, but this time it only needs the member data. It returns answer text (possibly depending on the user)

myAns.emote(member); // returns the emote with which the user needs to react in order to select this answer. Pro tip: do win+. if you are on win 10 in order to get a unicode emoji keyboard. ðŸ‘Œ 

myAns.exit(member); // returns the name of the dialogue following this answer (possibly depending on the user)
```

**TEXT BASED ANSWERS**

Imagine you want to create a shop dialogue, you can't just add one reaction emoji nor one answer in the tab for each item you can buy.
That's why you can specify in your question object that you want a text answer with a finite amount of arguments. 

```javascript
MyQuestionWithTextAns: {
	texte: function (up, am) {return "Whatever"},
    npc: npcList.myAwesomeNpc,
    
    answers: function (up) {  // you can only add one single text ans by question, more would make the bot to crash
    addTextAns(up, [2,"string","num"], "name of the question to play when the user will have sent its answer");   // [2 (this means there is 2 arguments needed), "string" (this means the first one is a text arg (ex: potato), "num" (this means the second one is an integer (ex: potato 5)] There is only "num" and "string" types of args available, it should be ok for any kind of use.
    return [0]; // you can still add emoji answers aside from your text one if you want. If none return [0].
    }
    
    footer: function (up) {return "Pro Tips: click on one of thoses reaction emotes to make your choice."}
}
```
Then in your next dialogue you can use what the user responded in order to create your text.
```javascript
MyQuestionDependingOnLastTextAns: {
/* am is a list variable. It contains the args of the member answer
	for instance if the user answered: "potato 5" then am == ["potato",5]
*/
	texte: function (up, am ) {
		switch (am[0]) {
			case "potato": return am[1] <= 30 ? "You buy "+am[1]+" "+am[0] : "oops sorry we don't have enough "+am[0]+" for you !";
			break;
			case "strawberry": return am[1] <= 100 ? "You buy "+am[1]+" "+am[0] : "oops sorry we don't have enough "+am[0]+" for you !";
			break;
			default: return "Sorry, our shop does not sell "+am[0];
		}
	},
	....
	....
}
```
